<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
   
    
  
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<!-- this file was missing -->

<!-- this file was moved after the jQuery Datatables library was laoded -->
<script type="text/javascript" src="https://cdn.datatables.net/1.10.9/js/dataTables.bootstrap.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Navbar</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Link</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Dropdown
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#">Action</a></li>
                  <li><a class="dropdown-item" href="#">Another action</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="#">Something else here</a></li>
                </ul>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled">Disabled</a>
              </li>
            </ul>
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>

      
    <div class="container mt-5 px-lg-5">
      <div class="d-flex justify-content-end">
        <!-- Button trigger modal -->
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
        Create User 
      </button>

      </div>
      <br>


      <br><br>
      <h1  class="text-center">Display User List</h1>
      <br>

      <div class="row">
        <div class="col-sm-12 col-md-6">
          <div class="dataTables_length" id="dtBasicExample_length">
            <section>Show 
              <select name="dtBasicExample_length" aria-controls="dtBasicExample" >
                <option value="10">10</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select> entries
            </label>
          </div>
        </div>
        <div class="col-sm-6 col-md-6 text-right">
          <form width="100px" role="search">
            <input class="form-control me-2" id="searchTitle" onkeyup="searchFun()" type="search" placeholder="Search" aria-label="Search">
          </form>
        </div>
      </div>
      <br>
      <div id="records_contant">
        <table class="table table-stripped table-bordered text-center" id="tabled" cellspacing="0" width="100%">

          <thead>
            <tr>
              <th>id</th>
              <th>User Type</th>
              <th>Name</th>
              <th>Mobile</th>
  
              <th>Password</th>
  
              <th>Date</th>
              <th>About</th>
              <th>Edit Action</th>
              <th >Delete Action</th>

            </tr>
          </thead>
          <tbody id="dataRes">
    
          </tbody>
          
        </table>

        <nav aria-label="Page navigation example text-right">
          <ul class="pagination float-right">
            <li class="page-item"><a class="page-link" href="#">Previous</a></li>
            <li class="page-item"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item"><a class="page-link" href="#">Next</a></li>
          </ul>
        </nav>
      </div>
     


      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">User Form</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="formid">
                <!-- 2 column grid layout with text inputs for the first and last names -->
                <div class="row mb-4">
                  <div class="col">
                    <div class="form-outline">
                      <input type="text" id="userName" class="form-control" name="userName" placeholder="User name" required/>
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-outline">
                      <input type="tel" id="mobile" class="form-control" placeholder="Mobile" name="mobile" maxlength="10" required/>
                    </div>
                  </div>
                </div>
              
                <!-- Email input -->
                <div class="form-outline mb-4">
                  <input type="email" id="email" class="form-control" name="email" placeholder="Email" required/>
                </div>
                
            
                
              
                <!-- passwrod input -->
                <div class="form-outline mb-4">
                  <input type="password" id="pass" class="form-control" name="pass" placeholder="Password" required/>
                </div>
  
                 <!-- Message input -->
                <div class="form-outline mb-4">
                  <textarea class="form-control" id="about" rows="4" name="about"  placeholder="Additional information"></textarea>
                
                </div>
                <div class="form-outline mb-4">
                  <label class="visually-hidden" for="inlineFormSelectPref">Preference</label>
                  <select class="form-select" aria-label="Default select example">
                    <option selected>Open this select user type</option>
                    <option value="1">Customer</option>
                    <option value="2">Broker</option>
                    <option value="3">Agent</option>
                  </select>
              </div>
              
              
              
               
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button id="buttonTwo"  type="submit" class="btn btn-primary"  data-bs-dismiss="modal">Create User</button>
            </div>
          </div>
        </div>
      </div>


      <!--Update Modal -->
      <div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">User Form</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form id="formidtwo">
                <!-- 2 column grid layout with text inputs for the first and last names -->
                <div class="row mb-4">
                  <div class="col">
                    <div class="form-outline">
                      <input type="text" id="update_userName" class="form-control" name="userName" placeholder="User name" required/>
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-outline">
                      <input type="tel" id="update_mobile" class="form-control" placeholder="Mobile" name="mobile" maxlength="10" required/>
                    </div>
                  </div>
                </div>
              
                <!-- Email input -->
                <div class="form-outline mb-4">
                  <input type="email" id="update_email" class="form-control" name="email" placeholder="Email" required/>
                </div>
                
            
                
              
                <!-- passwrod input -->
                <div class="form-outline mb-4">
                  <input type="password" id="update_pass" class="form-control" name="pass" placeholder="Password" required/>
                </div>

                <!-- Message input -->
                <div class="form-outline mb-4">
                  <textarea class="form-control" id="update_about" rows="4" name="about"  placeholder="Additional information"></textarea>
                
                </div>
                <div class="form-outline mb-4">
                  <label class="visually-hidden" for="inlineFormSelectPref">Preference</label>
                  <select class="form-select" aria-label="Default select example">
                    <option selected>Open this select user type</option>
                    <option value="1">Customer</option>
                    <option value="2">Broker</option>
                    <option value="3">Agent</option>
                  </select>
              </div>
              
              
              
              
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button onclick="update_buttonTwo()"  type="submit" class="btn btn-primary"  data-bs-dismiss="modal">Save User</button>
            </div>
            <input type="hidden" name="" id="hidden_user_id">
          </div>
        </div>
      </div>


    </div>



   

   

    <!-- <script>
      function onSubmitForm(){

        

        var name = document.getElementsByClassName("input")[0].value;
        var named = document.getElementsByClassName("input")[1].value;
        var toSend = {userType:name,data:named};
        var jsonString = JSON.stringify(toSend);
      

        var req = XMLHttpRequest();
        req.open("POST","/api/users");
        req.setRequestHeader("content-type","application/json; charset=utf-8")
        req.send(jsonString);
        


        return false;
      }
    </script> -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>

      function searchFun(){
        var keyval = $('#searchTitle').val().toLowerCase();
        if(keyval.length >0){
          $('#dataRes tr').filter(function(){
            $(this).toggle($(this).text().toLowerCase().indexOf(keyval) > -1)
          });
        }
        
      }

   
      function update_buttonTwo(){
        var id = $('#hidden_user_id').val();
          var name = $('#update_userName').val();
          var email = $('#update_email').val();
          var pass = $('#update_pass').val();
          var mobile= $("#update_mobile").val();
          var about= $("#update_about").val();
          var currentTime = new Date();
          var toSend = {userType:"Broker",
          userName:name,
          email:email,
          pass:pass,
          mobile:mobile,
          img:"https://google.com/img.png",
          price:"0",
          transactionId:"0",
          date:currentTime,
          block:"0",
          about:about,
          UserDOB: "dob",
          country: "India",
          state: "Uttar Pradesh",
          city: "Kanpur",
          street: "Street",
          landmark: "Z Square Mall",
          pancard: "ABCDE12345",
          aadhaar: "123412341234",
          totaldashboard: "0",
          totalproperty: "0"};
          $.ajax({
            url:"http://localhost:3000/api/users/"+id,
            type:"PUT",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(toSend),
            success: function(result,status){
              readRecords();
            },
            error: function(error){
              alert(JSON.stringify(error));
            }
          });
      }

      function DeleteUser(deleteid){
        var conf = confirm("Are you sure");
        if(conf == true){
          location.href = "public";
       //   location.href='https://google.com';
          $.ajax({
            url:"http://localhost:3000/api/users/"+deleteid,
            type:"DELETE",
            success: function(data,status){
              readRecords();
            },
            error: function(error){
              alert(JSON.stringify(error));
           }
          });
        }
        

      }

      function GetUserDetails(id){
      
        $("#hidden_user_id").val(id);
        

        
        $.ajax({
          url: "http://localhost:3000/api/users/"+id,
          type:"GET",
          success: function(data,status){
          
            
            $("#update_userName").val(data.userName);
            $("#update_mobile").val(data.mobile);
            $("#update_email").val(data.email);
            $("#update_pass").val(data.pass);
            $("#update_about").val(data.about);

           
          },
          error: function(error){
            alert(JSON.stringify(error));
          }
        });
        $("#updateModal").modal("show");
   

      }

      function readRecords(){
        $.ajax({
          url: "http://localhost:3000/api/users",
          type:"GET",
          success: function(data,status){
            if(data.length >0){
              var temp = "";

              // -- start for loop
              data.forEach((u)=>{
                temp +='<tr>';
                  temp +='<td>'+u._id+'</td>';
                  temp +='<td>'+u.userType+'</td>';
                  temp +='<td>'+u.userName+'</td>';
                  temp +='<td>'+u.mobile+'</td>';
                  temp +='<td>'+u.pass+'</td>';
                  temp +='<td>'+u.date+'</td>';
                  temp +='<td>'+u.about+'</td>';
                  temp +='<td ><button onclick="GetUserDetails('+"'"+u._id+"'"+')" class="btn btn-primary">Edit</button></td>';
                  temp +='<td ><button onclick="DeleteUser('+"'"+u._id+"'"+')" class="btn btn-danger">Delete</button></td></tr>';
              });
              $('#dataRes').html(temp);

             // document.getElementById("dataRes").innerHTML = temp;
              //-- close for loop
            }
          },
          error: function(error){
            alert(JSON.stringify(error));
          }
        })
      
      }

      $(document).ready(function(){

        readRecords();

        $('#buttonTwo').click(function(e){
          var a = $('#userType option:selected').val();
          var name = $('#userName').val();
          var email = $('#email').val();
          var pass = $('#pass').val();
          var mobile= $("#mobile").val();
          var about= $("#about").val();
          var currentTime = new Date();
          var toSend = {userType:"Broker",
          userName:name,
          email:email,
          pass:pass,
          mobile:mobile,
          img:"https://google.com/img.png",
          price:"0",
          transactionId:"0",
          date:currentTime,
          block:"0",
          about:about,
          UserDOB: "dob",
          country: "India",
          state: "Uttar Pradesh",
          city: "Kanpur",
          street: "Street",
          landmark: "Z Square Mall",
          pancard: "ABCDE12345",
          aadhaar: "123412341234",
          totaldashboard: "0",
          totalproperty: "0"};
          $.ajax({
            url:"http://localhost:3000/api/users",
            type:"POST",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(toSend),
            success: function(result,status){
              readRecords();
            },
            error: function(error){
              alert(JSON.stringify(error));
            }
          })
          
          e.preventDefault();
        
        });
      });
    </script>
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  </body>
</html>